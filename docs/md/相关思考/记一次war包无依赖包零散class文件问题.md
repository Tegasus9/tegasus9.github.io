# 记一次war包无依赖包class问题

~~记又一次被大佬秒杀的踩坑记录~~

## 问题起源

项目结构大致如下：

- `api` (jar)
- `common `(jar)
- `platform `(war)

platform依赖api和common。自己知道这三个模块分别是以什么形式打包进入项目中，但问题出现时自己并未意识到这一点。

问题发生时，笔者在api目录下所做的更改并没有在测试服务器上生效，于是有些疑惑，准备上服务器查看编译出来的class文件是否是最新版。

但自己进入SpringMvc如下目录时，并未找到api相对应的文件目录。只见到platform。如下图

![image-20220419174349873](https://my-first-picture-bed.oss-cn-guangzhou.aliyuncs.com/pic-bed/202204191743994.png)

目录中并没有`api`和`common`的反编译Class文件，这就让自己很疑惑。但更疑惑的是，项目竟然可以像往常一样启动。

（PS：自己记得以前打包出来的war有700M。而现在只有121M。所以很确信99%是没有将api和common打包进来。剩下的1%是给他正常启动留的空挡。）

于是自己在测试服务器上如何苦苦寻找和重启应用程序，都无法解决自己心头的疑问，无奈将这“闹鬼”一事转问给一位大佬。

## 秒解决知识性问题。

大佬首先了解了一下项目模块结构，然后在我寻找class文件的时候指出了我的错误之处。

他让我打开`lib`文件夹。这时候我就突然想到了什么。对哇，api和common是用JAR包的形式打包的，所以会以lib的形式存在于lib目录里。然后我果然在里面找到了两个静静躺着的jar包。

![image-20220419174805225](https://my-first-picture-bed.oss-cn-guangzhou.aliyuncs.com/pic-bed/202204191748253.png)

简直感动到哭啊有没有。

迷惑两小时的问题大佬一眼就能看出，可能这就是经验的力量吧。

事情到此基本上解决一大半问题了。至于为什么新的改动没有生效，仍旧没有搞清楚（PS：jar包已是最新版本，查看class文件可以看到新增语句，应用程序已重启，本地测试一切正常。而测试服务器上执行则漏了新改动语句。）但用另外的方式解决了，便不再探究。应该不是代码问题。

至此可以得出一些相关结论。

## 相关结论：

**以jar包形式打包的依赖，不会在war包中存在零散的class文件，而是以.jar形式存储。**